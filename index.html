 <html>
 <Head>
 <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1" id="viewport-meta" />
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="">
	<title>Générateur mobile d'autorisation de déplacement</title>
 <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
	<script type="application/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

	<script type="application/javascript">
      
	 function popup(){
setTimeout(function(){ alert('Remplissez les champs puis cliquez sur "générer le document"'); }, 1000);
}
   
   
   
   
   
   
      function generatePDF() {
        // Choose the element that our invoice is rendered in.
        var element = document.getElementById("printCOVIDPDF");
        // Define options :
		var opt = {
  filename:     'confinement-coronavirus.pdf',
  image:        { type: 'jpeg', quality: 0.98 },
};
		// Choose the element and save the PDF for our user.
       setTimeout(function(){ html2pdf().set(opt).from(element).save();}, 1000);
      }
	  
	  
	  
	  
    </script>
	
    <style>
    .paper-box {
        max-width: 800px;
        margin: auto;
        padding: 30px;
        border: 1px solid #eee;
        box-shadow: 0 0 10px rgba(0, 0, 0, .15);
        font-size: 15px;
        line-height: 20px;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
		background: #fff;
    }
	
	.form-box {
        max-width: 800px;
        margin: auto;
        padding: 10px;
        font-size: 15px;
        line-height: 20px;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
		background: #fff;
    }	
    
    .paper-box table {
        width: 100%;
        line-height: inherit;
        text-align: left;
    }
    
    .paper-box table td {
        padding: 5px;
        vertical-align: top;
    }
    
    
    .paper-box table tr.top table td {
        padding-bottom: 20px;
    }
    
    .paper-box table tr.top table td.title {
        font-size: 45px;
        line-height: 45px;
        color: #333;
    }
    
    .paper-box table tr.information table td {
        padding-bottom: 40px;
		text-align:left;
		font-size: 15px;
        line-height: 20px;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
    }
	
	
    
    .paper-box table tr.entete td {
       background: #fff;
       color: #555;
        border-bottom: 1px solid #ddd;
        font-weight: bold;
    }
    
    .paper-box table tr.details td {
        padding-bottom: 20px;
    }
	
    
    .paper-box table tr.optionscovidpdf td{
        border-bottom: 1px solid #eee;
		font-size: 13px;
        line-height: 20px;
       
    }
    
    .paper-box table tr.optionscovidpdf.last td {
        border-bottom: none;
		font-size: 13px;
        line-height: 20px;
       
    }
    
    .paper-box table tr td.total {
        border-top: 2px solid #eee;
        font-weight: bold;
    }
	
	
	textarea.coord {
		font-size: 15px;
        line-height: 25px;
        padding:0;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
		border:0px;
		text-align: right;
		resize:none;
		background-color:#f3f6f9;
	}
	
	textarea.generator {
		font-size: 15px;
        line-height: 25px;
        padding:0;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
		border:0px;
		text-align: right;
		resize:none;
		background-color:#f3f6f9;
	}
	
	title {
		font-size: 30px;
        line-height: 40px;
        font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        color: #555;
		border:0px;	
	}
    
    @media only screen and (max-width: 600px) {
        
		.paper-box table tr.top table td {
            width: 100%;
			display: block;
            text-align: center;
        }
        
        .paper-box table tr.information table td {
            width: 100%;
            display: block;
            text-align: center;
        }
		
		.paper-box table tr.information table td.sousigne {
            width: 100%s;
            display: block;
            text-align: center;
        }
    }
	
	@media (max-width: 600px) {
        .paper-box {
			border: 0px solid #eee;
			box-shadow: 0 0 10px rgba(0, 0, 0, .0);
			padding:30px 0 0 0;
			margin-top:0px;
		}
		
		.paper-box table tr.top table td.title {
			padding-bottom: 50px;
			width: 100%;
            display: block;
            text-align: center;
    }		
    }
	
.square_btn {
	display: inline-block;
    padding: 0.3em 1em;
    font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
	text-decoration: none;
    color: #eee;
    border: solid 2px #555;
    border-radius: 3px;
	background: #555;
    transition: .4s;
}

.square_btn:hover {
    background: #eee;
    color: #555;
} 
	
	* {
  margin:0;
  padding:0;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.bouton {
	text-align:center;
	width:300px;
	margin:15px auto;
	font-family: 'Libre Franklin', 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
	font-size: 15px;
    line-height: 20px;
}

#sig-canvas {
			border: 2px solid #f3f6f9;
			border-radius: 5px;
			cursor: crosshair;
		}
    </style>
	</head>
	<body onload="popup()">
	<div>
	<div id="formPDF" class="form-box" style="display:block;">
	<div>Mme / M:<br> <textarea class="generator" rows="1" id="Gen1" maxlength="100"></textarea></div>
	<div>Né(e) le:<br> <textarea class="generator" rows="1" id="Gen2" maxlength="100"></textarea></div>
	<div>Demeurant : <br> <textarea class="generator" rows="4" id="Gen3" maxlength="100"></textarea></div>
	<div>Fait à : <br><textarea class="generator" rows="1" id="Gen4" maxlength="100"></textarea></div>
	<div>le : <br><textarea class="generator" rows="1" id="Gen5" maxlength="100"></textarea></div>
	Signature : <br><canvas id="sig-canvas" width="400" height="160"></canvas><br>
				<button class="btn btn-primary" onclick="Copydata();" id="sig-submitBtn">Générer le document</button>
				<button class="btn btn-default" id="sig-clearBtn">Refaire Signature</button>
				<textarea style="display:none;" id="sig-dataUrl" class="form-control" rows="5"></textarea>
<br>	
</div>
	<div id="printCOVIDPDF" class="paper-box" style="display:none;">
	<div>
        <div>
		<table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="3">   
                </td>
            </tr>   
            <tr class="information">
                
                   
                            <td>
                                <b>ATTESTATION DE DÉPLACEMENT DÉROGATOIRE</b><br>
                                En application de l’article 1er du décret du 16 mars 2020 portant réglementation des
déplacements dans le cadre de la lutte contre la propagation du virus Covid-19 :<br>  
                            <td class="sousigne" style="padding-left:100px;">
								<b>Je sousigné :</b><br>
                                Mme / M: <textarea readonly="readonly" style="width:100%;" class="coord" rows="1" id="iciGen1"></textarea>
								Né(e) le :  <textarea readonly="readonly" style="width:100%;" class="coord" rows="1" id="iciGen2"></textarea>
								Demeurant : <textarea readonly="readonly"  style="width:100%;" class="coord" rows="4" id="iciGen3"></textarea>
                            </td>
                        
                </td>
            </tr>
            <tr class="entete">
                <td colspan="2"><br>
                    <div>certifie que mon déplacement est lié au motif suivant (cocher la case) autorisé par
l’article 1er du décret du 16 mars 2020 portant réglementation des déplacements dans
le cadre de la lutte contre la propagation du virus Covid-19 :</div>
                </td>   
            </tr>
          <tr class="optionscovidpdf">
                <td colspan="2">			
				<div>
  <input type="checkbox" id="covidpdf" name="covidpdf">
  <label for="covidpdf">déplacements entre le domicile et le lieu d’exercice de l’activité professionnelle,
lorsqu’ils sont indispensables à l’exercice d’activités ne pouvant être organisées
sous forme de télétravail (sur justificatif permanent) ou déplacements
professionnels ne pouvant être différés ;</label>
</div>		
<div>
  <input type="checkbox" id="covidpdf" name="covidpdf">
  <label for="covidpdf">déplacements pour effectuer des achats de première nécessité dans des
établissements autorisés (liste sur gouvernement.fr); </label>
</div>

<div>
  <input type="checkbox" id="covidpdf" name="covidpdf">
  <label for="covidpdf">déplacements pour motif de santé;</label>
</div>
<div>
  <input type="checkbox" id="covidpdf" name="covidpdf">
  <label for="covidpdf">déplacements pour motif familial impérieux, pour l’assistance aux personnes
vulnérables ou la garde d’enfants ;</label>
</div>
<div>
  <input type="checkbox" id="covidpdf" name="covidpdf">
  <label for="covidpdf">déplacements brefs, à proximité du domicile, liés à l’activité physique individuelle
des personnes, à l’exclusion de toute pratique sportive collective, et aux besoins
des animaux de compagnie.</label>
</div>			          
                </td>
            </tr>           
            <td class="sousigne">
								Fait à :<textarea readonly="readonly" style="width:300px;"  class="coord" rows="1" id="iciGen4"></textarea>
								<br>le :<textarea readonly="readonly" style="width:100px;" class="coord" rows="1" id="iciGen5"></textarea>
								<br>Signature : <br>
				<img id="sig-image" src=""/>
                            </td>                      
        </table>
    </div>
             

</div>
</div>
<div class="bouton" style="display:none;" id="boutonGen"><a href="#" class="square_btn" onclick="generatePDF();">Générer le PDF</a></div>
</div>      
</div>
<script type="text/javascript">
   (function() {
	
	// Get a regular interval for drawing to the screen
	window.requestAnimFrame = (function (callback) {
		return window.requestAnimationFrame || 
					window.webkitRequestAnimationFrame ||
					window.mozRequestAnimationFrame ||
					window.oRequestAnimationFrame ||
					window.msRequestAnimaitonFrame ||
					function (callback) {
					 	window.setTimeout(callback, 1000/60);
					};
	})();

	// Set up the canvas
	var canvas = document.getElementById("sig-canvas");
	var ctx = canvas.getContext("2d");
	ctx.strokeStyle = "#222222";
	ctx.lineWith = 2;

	// Set up the UI
	var sigText = document.getElementById("sig-dataUrl");
	var sigImage = document.getElementById("sig-image");
	var clearBtn = document.getElementById("sig-clearBtn");
	var submitBtn = document.getElementById("sig-submitBtn");
	clearBtn.addEventListener("click", function (e) {
		clearCanvas();
		sigText.innerHTML = "Data URL for your signature will go here!";
		sigImage.setAttribute("src", "");
	}, false);
	submitBtn.addEventListener("click", function (e) {
	
  $("#iciGen1").val($("#Gen1").val());
 $("#iciGen2").val($("#Gen2").val());
  $("#iciGen3").val($("#Gen3").val());
   $("#iciGen4").val($("#Gen4").val());
    $("#iciGen5").val($("#Gen5").val());
	document.getElementById("printCOVIDPDF").style.display="block";
	document.getElementById("formPDF").style.display="none";
	document.getElementById("boutonGen").style.display="block";
	document.getElementById("viewport-meta").setAttribute("content", "initial-scale=1, width=600px");
	setTimeout(function(){ alert('Cochez la raison de votre déplacmenet puis cliquez sur "générer le PDF"'); }, 1000);

		var dataUrl = canvas.toDataURL();
		sigText.innerHTML = dataUrl;
		sigImage.setAttribute("src", dataUrl);
}, false);

	// Set up mouse events for drawing
	var drawing = false;
	var mousePos = { x:0, y:0 };
	var lastPos = mousePos;
	canvas.addEventListener("mousedown", function (e) {
		drawing = true;
		lastPos = getMousePos(canvas, e);
	}, false);
	canvas.addEventListener("mouseup", function (e) {
		drawing = false;
	}, false);
	canvas.addEventListener("mousemove", function (e) {
		mousePos = getMousePos(canvas, e);
	}, false);

	// Set up touch events for mobile, etc
	canvas.addEventListener("touchstart", function (e) {
		mousePos = getTouchPos(canvas, e);
		var touch = e.touches[0];
		var mouseEvent = new MouseEvent("mousedown", {
			clientX: touch.clientX,
			clientY: touch.clientY
		});
		canvas.dispatchEvent(mouseEvent);
	}, false);
	canvas.addEventListener("touchend", function (e) {
		var mouseEvent = new MouseEvent("mouseup", {});
		canvas.dispatchEvent(mouseEvent);
	}, false);
	canvas.addEventListener("touchmove", function (e) {
		var touch = e.touches[0];
		var mouseEvent = new MouseEvent("mousemove", {
			clientX: touch.clientX,
			clientY: touch.clientY
		});
		canvas.dispatchEvent(mouseEvent);
	}, false);

	// Prevent scrolling when touching the canvas
	document.body.addEventListener("touchstart", function (e) {
		if (e.target == canvas) {
			e.preventDefault();
		}
	}, false);
	document.body.addEventListener("touchend", function (e) {
		if (e.target == canvas) {
			e.preventDefault();
		}
	}, false);
	document.body.addEventListener("touchmove", function (e) {
		if (e.target == canvas) {
			e.preventDefault();
		}
	}, false);

	// Get the position of the mouse relative to the canvas
	function getMousePos(canvasDom, mouseEvent) {
		var rect = canvasDom.getBoundingClientRect();
		return {
			x: mouseEvent.clientX - rect.left,
			y: mouseEvent.clientY - rect.top
		};
	}

	// Get the position of a touch relative to the canvas
	function getTouchPos(canvasDom, touchEvent) {
		var rect = canvasDom.getBoundingClientRect();
		return {
			x: touchEvent.touches[0].clientX - rect.left,
			y: touchEvent.touches[0].clientY - rect.top
		};
	}

	// Draw to the canvas
	function renderCanvas() {
		if (drawing) {
			ctx.moveTo(lastPos.x, lastPos.y);
			ctx.lineTo(mousePos.x, mousePos.y);
			ctx.stroke();
			lastPos = mousePos;
		}
	}

	function clearCanvas() {
		canvas.width = canvas.width;
	}

	// Allow for animation
	(function drawLoop () {
		requestAnimFrame(drawLoop);
		renderCanvas();
	})();

})();
</script>
</body>
</html>
